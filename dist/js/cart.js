"use strict";var timeout1=void 0,last_top=document.querySelector("#last_top"),cart_btn=document.querySelector(".cart_btn");function down(){var c=0,o=0;$(".goods_box :checkbox").each(function(e,t){if(t.checked){var n=$(t).parent().siblings(".small_price").text();n=n.slice(1),o+=n-0,c+=$(t).parent().siblings(".gods_price").children("input").val()-0}}),$(".goods_sum").text(c),$(".sum_price").text("￥"+o)}if(document.cookie){var uname=document.cookie.slice(5);$.get("http://localhost//huaweishangcheng/src/php/cart.php",{name:uname},function(n){if(n)for(var e=function(t){$.get("http://localhost//huaweishangcheng/src/php/goods_box.php",{pid:n[t].good_id},function(e){$li=$("<li></li>"),$str='\n                        <ol>\n                            <li><input type="checkbox"></li>\n                            <li><img src='+e[0].url+' alt=""></li>\n                            <li>\n                                <p>'+e[0].name+'</p>\n                                <p>自选 </p>\n                            </li>\n                            <li class="gods_price_odd">￥<span>'+e[0].price+'</span></li>\n                            <li class="gods_price">\n                                <div class="add_btn">+</div>\n                                <input type="text" value="'+n[t].good_num+'">\n                                <div class="remove_btn">-</div>\n                            </li>\n                            <li  class="small_price">￥'+e[0].price*n[t].good_num+'</li>\n                            <li><p class="del" index='+e[0].id+">删除</p></li>\n                        </ol>\n                    ",$li.html($str),$(".cart_mouther").append($li),0==$(".cart_mouther li").length?($(".cart").css({display:"block"}),$(".goods_price").css({display:"none"}),$(".cart_top").css({display:"none"})):($(".cart").css({display:"none"}),$(".goods_price").css({display:"block"}),$(".cart_top").css({display:"block"})),$li.children().children().children(".del").click(function(){var e=this;layer.confirm("您确定要删除商品吗？",{btn:["确定","取消"]},function(){$.get("http://localhost//huaweishangcheng/src/php/cart_remove.php",{uname:uname,id:$(e).attr("index")},function(e){console.log(e)},"json"),$(e).parent().parent().parent().remove(),parent.layer.closeAll(),down(),$(".cart_mouther li").length?($(".cart").css({display:"none"}),$(".goods_price").css({display:"block"}),$(".cart_top").css({display:"block"})):($(".cart").css({display:"block"}),$(".goods_price").css({display:"none"}),$(".cart_top").css({display:"none"}))},function(){parent.layer.closeAll()})}),$li.children().children().children("input[type='checkbox']").change(function(){down(),$(this).is(":checked")?($(this).parent().parent().css({backgroundColor:"wheat"}),$(".goods_box :checkbox").each(function(e,t){if(!t.checked)return $(".checkbox :checkbox").prop({checked:!1}),!1;$(".checkbox :checkbox").prop({checked:!0})})):($(this).parent().parent().css({backgroundColor:"transparent"}),$(".checkbox :checkbox").prop({checked:!1})),down()}),$li.children().children().children(".add_btn").click(function(){var e=this;if(10<=$(this).next().val())return layer.msg("该商品限购 10 件 !"),!1;$(this).next().val($(this).next().val()-0+1).parent().next().text("￥"+$(this).next().val()*$(this).parent().prev().children("span").text()),down(),clearTimeout(timeout1),timeout1=setTimeout(function(){$.get("http://localhost//huaweishangcheng/src/php/change_cart.php",{id:$(e).parent().next().next().children("p").attr("index"),num:$(e).next().val(),uname:uname,flag:1},function(){},"json")},1e3)}),$li.children().children().children(".remove_btn").click(function(){var e=this;if(1==$(this).prev().val())return $(this),layer.msg("商品数不能小于 1 !"),!1;$(this).prev().val($(this).prev().val()-1).parent().next().text("￥"+$(this).prev().val()*$(this).parent().prev().children("span").text()),down(),clearTimeout(timeout1),timeout1=setTimeout(function(){$.get("http://localhost//huaweishangcheng/src/php/change_cart.php",{id:$(e).parent().next().next().children("p").attr("index"),num:$(e).prev().val(),uname:uname,flag:1},function(){},"json")},1e3)}),$li.children().children().children("input[type='text']").blur(function(){$(this).val()<=0?$(this).val(1):10<=$(this).val()?$(this).val(10):isNaN($(this).val()-0)&&$(this).val(1),$(this).val(parseInt($(this).val())),$(this).parent().next().text("￥"+$(this).parent().prev().children("span").text()*$(this).val()),down(),$.get("http://localhost//huaweishangcheng/src/php/change_cart.php",{id:$(this).parent().next().next().children("p").attr("index"),num:$(this).val(),uname:uname,flag:1},function(){},"json")})},"json")},t=0;t<n.length;t++)e(t)},"json")}else $(".top_banner").css("display","block");$(".second_list_one").parent().hover(function(){$(".second_list_one")[0].style.display="block"},function(){$(".second_list_one")[0].style.display="none"}),$(".second_list_two").parent().hover(function(){$(".second_list_two")[0].style.display="block"},function(){$(".second_list_two")[0].style.display="none"}),$(".checkbox :checkbox").change(function(){$(this).is(":checked")?($(".goods_box ol").css({backgroundColor:"wheat"}),$(":checkbox").prop({checked:!0})):($(".goods_box ol").css({backgroundColor:"transparent"}),$(":checkbox").prop({checked:!1})),down()}),document.cookie?($(".login_li").text("您好"),$(".name_li").text(document.cookie.slice(5).slice(0,2)+"**"),$(".login_p").text("欢迎您,"+document.cookie.slice(5).slice(0,2)+"**"),$out=$("<li></li>"),$out.text("退出"),$(".login_li").before($out),$(".login_li").prev().click(function(){layer.confirm("您确定要退出吗？",{icon:5,skin:"layui-layer-lan",btn:["残忍离开","再逛逛"]},function(){removeCookie("name"),$(".login_li").html("<a href='http://localhost/huaweishangcheng/src/login.html'>登录</a>"),$(".name_li").html("<a href='http://localhost/huaweishangcheng/src/register.html'>注册</a>"),$(".login_p").html('您好，请<a href="http://localhost/huaweishangcheng/src/login.html">登录 </a><span> / </span><a href="http://localhost/huaweishangcheng/src/register.html">注册</a>'),$(".cart_mouther li").remove(),parent.layer.closeAll(),$(".cart_mouther li").length?($(".cart").css({display:"none"}),$(".goods_price").css({display:"block"}),$(".cart_top").css({display:"block"})):($(".cart").css({display:"block"}),$(".goods_price").css({display:"none"}),$(".cart_top").css({display:"none"})),$(".top_banner").css("display","block")},function(){parent.layer.closeAll()})}),0==$(".cart_mouther li").length?($(".cart").css({display:"block"}),$(".goods_price").css({display:"none"}),$(".cart_top").css({display:"none"})):$(".cart").css({display:"none"})):0==$(".cart_mouther li").length&&($(".cart").css({display:"block"}),$(".goods_price").css({display:"none"}),$(".cart_top").css({display:"none"})),$(".rm_all").click(function(){if(0===$(".goods_box input:checked").length)return layer.msg("您还未选中任何商品"),!1;layer.confirm("您确定要删除所选商品吗？",{btn:["确定","取消"]},function(){var n=[];$(".goods_box input:checked").each(function(e,t){$i=$(t).parent().siblings().last().children(".del").attr("index"),n.push($i)});for(var e=0;e<n.length;e++)$.get("http://localhost//huaweishangcheng/src/php/cart_remove.php",{uname:document.cookie.slice(5),id:n[e]},function(e){$(".cart_mouther li").length?($(".cart").css({display:"none"}),$(".goods_price").css({display:"block"}),$(".cart_top").css({display:"block"})):($(".cart").css({display:"block"}),$(".goods_price").css({display:"none"}),$(".cart_top").css({display:"none"})),down()},"json");$(".goods_box li").remove(),parent.layer.closeAll()})}),window.onscroll=function(){600<=document.documentElement.scrollTop?last_top.style.display="block":last_top.style.display="none"},last_top.onclick=function(){var e=setInterval(function(){document.documentElement.scrollTop-=100,document.documentElement.scrollTop<=0&&clearInterval(e)},1)},cart_btn.onclick=function(){location.href="http://localhost/huaweishangcheng/src/cart.html"};