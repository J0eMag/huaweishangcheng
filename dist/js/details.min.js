"use strict";var show_list=document.querySelectorAll(".list_nav>li"),second_list_boxx=document.querySelector("#second_list_box"),tj_type=getParams("id"),last_top=document.querySelector("#last_top"),cart_btn=document.querySelector(".cart_btn");function getParams(o){var t=new RegExp("(^|&)"+o+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(t);return null!=e?unescape(e[2]):null}$(".second_list_one").parent().hover(function(){$(".second_list_one")[0].style.display="block"},function(){$(".second_list_one")[0].style.display="none"}),$(".second_list_two").parent().hover(function(){$(".second_list_two")[0].style.display="block"},function(){$(".second_list_two")[0].style.display="none"}),$(".second_list").click(function(){$(this).parent().next().toggleClass("shua"),$(".shadow").click(function(){if(13==$(this).index())return!1;window.open("http://localhost//huaweishangcheng/src/list.html?id="+($(this).index()-0+3))})}),$(".none").focus(function(){$(".sls").css({display:"none"})}),$(".none").blur(function(){$(".sls").css({display:"block"})});for(var _loop=function(o){show_list[o-1].onmouseover=function(){second_list_boxx.style.display="flex",promiseAjax({url:"http://localhost/huaweishangcheng/src/php/second_list.php",data:{id:o}}).then(function(o){for(var t="",e=0;e<o.length;e++)t+="\n                <li>\n                <img src="+o[e].url+">\n                <span>"+o[e].name+"</span>\n                </li>\n                ";second_list_boxx.innerHTML=t;var n=second_list_boxx.querySelectorAll("img"),s=second_list_boxx.querySelectorAll("li");n.forEach(function(o){setStyle(o,{width:"48px",height:"48px",marginTop:"5px",float:"left",marginRight:"20px",marginLeft:"30px"})}),s.forEach(function(o){setStyle(o,{width:"230px",height:"60px",margin:"14px 10px",borderRadius:"10px"}),o.onmouseover=function(){o.style.backgroundColor="#eee"},o.onmouseout=function(){o.style.backgroundColor="transparent"}}),second_list_boxx.style.width=250*Math.ceil(o.length/5)+"px"})},second_list_boxx.onmouseover=function(){second_list_boxx.style.display="flex"},show_list[o-1].onmouseout=second_list_boxx.onmouseout=function(){second_list_boxx.style.display="none"}},i=1;i<=show_list.length;i++)_loop(i);$(".goods_img").mouseenter(function(){$(".mask").css({display:"block"}).parent().next().css({display:"block"}),$(".goods_img").mousemove(function(o){var t=o.pageX-$(".goods_img").offset().left-112.5,e=o.pageY-$(".goods_img").offset().top-112.5;t<0&&(t=0),e<0&&(e=0),225<=t&&(t=225),225<=e&&(e=225),$(".mask").css({top:e,left:t}),$(".mirror").css({backgroundPosition:2*-t+"px "+2*-e+"px"})})}),$(".goods_img").mouseleave(function(o){$(".mask").css({display:"none"}).parent().next().css({display:"none"})}),$(".add_btn").click(function(){if(10<=$(".price_box input").val())return layer.msg("该商品限购 10 件!"),!1;$(".price_box input").val($(".price_box input").val()-0+1)}),$(".remove_btn").click(function(){if(1==$(".price_box input").val())return layer.msg("再减就没了哟~"),!1;$(".price_box input").val($(".price_box input").val()-1)}),$(".price_box input").blur(function(){$(this).val()<=0?$(this).val(1):10<=$(this).val()?$(this).val(10):isNaN($(this).val()-0)&&$(this).val(1),$(this).val(parseInt($(this).val()))}),$.get("http://localhost//huaweishangcheng/src/php/goods_img.php",{id:tj_type},function(o){var t=o[0],e=[],n=0;for(var s in t){if(null==t[s]){delete t[s];break}if(isNaN(t[s]-0)||n++,2===n)break;e.push(t[s]),console.log(n)}7<=e.length&&e.pop();for(var i=1;i<e.length;i++)$li=$('<li class="small_goods_img"></li>'),1===i&&$li.addClass("s_img_active"),$li.css({backgroundImage:"url("+e[i]+")"}),$(".goods_small_img").append($li);$(".goods_img").css({backgroundImage:"url("+e[1]+")"}).next().css({backgroundImage:"url("+e[1]+")"}),$(".small_goods_img").click(function(){$(this).addClass("s_img_active").siblings().removeClass("s_img_active"),$(".goods_img").css({backgroundImage:$(this).css("background-image")}).next().css({backgroundImage:$(this).css("background-image")})});var l=[];for(var c in o[0])null==o[0][c]&&delete o[0][c],l.push(o[0][c]);for(var a=l.slice(e.length+1),r=0;r<a.length;r++)$img=$('<img class="goods_iimmgg" src='+a[r]+">"),$("#goods_iimmgg").append($img);$img1=$('<img class="goods_iimmgg" src="https://res.vmallres.com/pimages/detailImg/2021/03/03/A1B84352CAB07B7441C5EB3AA6E278E23FAED949397499BD.jpg">'),$("#goods_iimmgg").append($img1)},"json"),$.get("http://localhost//huaweishangcheng/src/php/goods_box.php",{pid:tj_type},function(o){$(".good_name").text(o[0].name).next().text(o[0].tip),$(".good_price").text("￥"+o[0].price)},"json"),$(".add_cart").click(function(){if(!document.cookie)return layer.msg("请先登录再操作"),!1;$.get("http://localhost//huaweishangcheng/src/php/change_cart.php",{id:tj_type,num:$(".price_box input").val(),uname:document.cookie.slice(5)},function(o){layer.confirm($(".good_name").text()+"成功加入购物车",{icon:1,skin:"layui-layer-molv",btn:["再逛逛","去结算"]},function(){parent.layer.closeAll()},function(){location.href="http://localhost/huaweishangcheng/src/cart.html"})},"json")}),document.cookie&&($(".login_li").text("您好"),$(".name_li").text(document.cookie.slice(5).slice(0,2)+"**"),$(".login_p").text("欢迎您,"+document.cookie.slice(5).slice(0,2)+"**"),$out=$("<li></li>"),$out.text("退出"),$(".login_li").before($out),$(".login_li").prev().click(function(){removeCookie("name"),$(".login_li").html("<a href='http://localhost/huaweishangcheng/src/login.html'>登录</a>"),$(".name_li").html('<a href="http://localhost/huaweishangcheng/src/register.html">注册</a>'),$(".login_p").html('您好，请<a href="http://localhost/huaweishangcheng/src/login.html">登录 </a><span> / </span><a href="http://localhost/huaweishangcheng/src/register.html">注册</a>'),$(this).remove()})),window.onscroll=function(){600<=document.documentElement.scrollTop?last_top.style.display="block":last_top.style.display="none"},last_top.onclick=function(){var o=setInterval(function(){document.documentElement.scrollTop-=100,document.documentElement.scrollTop<=0&&clearInterval(o)},1)},cart_btn.onclick=function(){location.href="http://localhost/huaweishangcheng/src/cart.html"};